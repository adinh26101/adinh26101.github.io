---
title: "Nháº­n Dáº¡ng Thiáº¿t Bá»‹ Dá»±a TrÃªn TÃ­n Hiá»‡u VÃ´ Tuyáº¿n SÆ°Ì‰ DuÌ£ng Deep Metric Learning"
date: 2025-09-02-rff 10:00:00 +0000
categories: [Machine Learning, Deep Learning, Radio Frequency Fingerprinting]
tags: [Radio Frequency Fingerprinting, Signal Processing, RiftNet, OpenSet Problem, Metric Learning]
author: adinh26101
icon: fas fa-chart-bar
lang: vi
math: true
permalink: /posts/rff-based-device-identify/
---

### NÃ´Ì£i Dung
- [1. GiÆ¡Ìi thiÃªÌ£u](#-introduction)
- [2. CaÌc nghiÃªn cÆ°Ìu liÃªn quan](#-related-work)
- [3. PhÆ°Æ¡ng phaÌp](#-method)
- [4. ThÆ°Ì‰ nghiÃªÌ£m](#-experiment)
- [5. KÃªÌt quaÌ‰](#-result)


<a name="-introduction"></a>  
## 1. GiÆ¡Ìi thiÃªÌ£u

**Radio Frequency Fingerprinting (RFF)** lÃ  ká»¹ thuáº­t nháº­n dáº¡ng thiáº¿t bá»‹ vÃ´ tuyáº¿n dá»±a trÃªn Ä‘áº·c trÆ°ng duy nháº¥t (*fingerprint*) phÃ¡t sinh tá»« **sai lá»‡ch pháº§n cá»©ng** trong quÃ¡ trÃ¬nh truyá»n tÃ­n hiá»‡u RF.

<p>
    <img src="assets/2025-09-02-rff/signal_component.png" alt="ThaÌ€nh phÃ¢Ì€n cÆ¡ baÌ‰n cuÌ‰a tiÌn hiÃªÌ£u"/>
</p>

- Má»—i thiáº¿t bá»‹ (WiFi, IoT, Ä‘iá»‡n thoáº¡i, drone, v.v.) khi phÃ¡t sÃ³ng Ä‘á»u cÃ³ nhá»¯ng **lá»—i nhá» khÃ´ng thá»ƒ trÃ¡nh** trong máº¡ch (*oscillator, PA, DAC...*).  
- Nhá»¯ng sai lá»‡ch nÃ y táº¡o nÃªn má»™t **â€œdáº¥u vÃ¢n tayâ€ Ä‘iá»‡n tá»«** riÃªng biá»‡t.  
- Báº±ng cÃ¡ch **trÃ­ch xuáº¥t cÃ¡c Ä‘áº·c trÆ°ng** nÃ y tá»« tÃ­n hiá»‡u nháº­n Ä‘Æ°á»£c (vÃ­ dá»¥: *IQ imbalance, phase noise, transient, spectral features*â€¦), ta cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh vÃ  phÃ¢n biá»‡t thiáº¿t bá»‹ ngay cáº£ khi chÃºng dÃ¹ng **cÃ¹ng chuáº©n truyá»n thÃ´ng vÃ  Ä‘á»‹a chá»‰ MAC/IP**.  

### á»¨ng dá»¥ng chÃ­nh cá»§a RFF
- **An ninh máº¡ng khÃ´ng dÃ¢y**: phÃ¡t hiá»‡n giáº£ máº¡o, ngÄƒn spoofing.  
- **IoT**: nháº­n dáº¡ng vÃ  xÃ¡c thá»±c thiáº¿t bá»‹ nháº¹ nhÃ ng, khÃ´ng cáº§n giao thá»©c náº·ng.  
- **QuÃ¢n sá»± & Drone**: phÃ¢n biá»‡t mÃ¡y bay khÃ´ng ngÆ°á»i lÃ¡i.  

<a name="-related-work"></a>  
## 2. CÃ¡c nghiÃªn cá»©u liÃªn quan

### Nháº­n dáº¡ng tÃ­n hiá»‡u transient
CÃ¡c nghiÃªn cá»©u cho tháº¥y giai Ä‘oáº¡n *transient* trong tÃ­n hiá»‡u vÃ´ tuyáº¿n (giá»¯a nhiá»…u vÃ  á»•n Ä‘á»‹nh) chá»©a nhiá»u Ä‘áº·c trÆ°ng quan trá»ng cho viá»‡c nháº­n dáº¡ng thiáº¿t bá»‹. Viá»‡c xÃ¡c Ä‘á»‹nh chÃ­nh xÃ¡c ranh giá»›i *transient* lÃ  then chá»‘t, trÃ¡nh sai lá»‡ch áº£nh hÆ°á»Ÿng Ä‘áº¿n quÃ¡ trÃ¬nh trÃ­ch xuáº¥t Ä‘áº·c trÆ°ng vÃ  huáº¥n luyá»‡n.  

Hai phÆ°Æ¡ng phÃ¡p phá»• biáº¿n Ä‘á»ƒ phÃ¡t hiá»‡n:
- **Bayesian change point detection**: dá»±a trÃªn thay Ä‘á»•i *fractal dimension*.  
- **Phase-Based detection**: dá»±a trÃªn biáº¿n thiÃªn pha tuyáº¿n tÃ­nh trong giai Ä‘oáº¡n *transient*.  

### á»¨ng dá»¥ng Há»c mÃ¡y vÃ  Há»c sÃ¢u
Sau khi tÃ¡ch Ä‘Æ°á»£c tÃ­n hiá»‡u *transient*, cÃ¡c mÃ´ hÃ¬nh há»c mÃ¡y cÃ³ giÃ¡m sÃ¡t nhÆ° **SVM** cho káº¿t quáº£ tá»‘t, nhÆ°ng phá»¥ thuá»™c máº¡nh vÃ o tÃ­nh chÃ­nh xÃ¡c cá»§a viá»‡c tÃ¡ch *transient*.  

Äá»ƒ kháº¯c phá»¥c, **há»c sÃ¢u (CNN, LSTM)** táº­n dá»¥ng toÃ n bá»™ tÃ­n hiá»‡u, giáº£m phá»¥ thuá»™c vÃ o bÆ°á»›c xÃ¡c Ä‘á»‹nh *transient* vÃ  nÃ¢ng cao Ä‘á»™ chÃ­nh xÃ¡c. Gáº§n Ä‘Ã¢y, cÃ¡c mÃ´ hÃ¬nh nhÆ° **RiftNet** Ä‘Æ°á»£c Ã¡p dá»¥ng Ä‘á»ƒ nháº­n dáº¡ng thiáº¿t bá»‹ tá»« tÃ­n hiá»‡u Bluetooth cá»§a Ä‘iá»‡n thoáº¡i thÃ´ng minh.

<a name="-method"></a>  
## 3. PhÆ°Æ¡ng phaÌp

### PhÃ¢n loáº¡i tÃ­n hiá»‡u vá»›i Machine Learning

#### Äáº·c trÆ°ng pha tá»©c thá»i
- Dá»±a trÃªn tÃ­n hiá»‡u *transient-based RF fingerprinting*.  
- TrÃ­ch xuáº¥t cÃ¡c Ä‘áº·c trÆ°ng thá»‘ng kÃª báº­c cao: **skewness, kurtosis, variance** tá»«:
  - BiÃªn Ä‘á»™ tá»©c thá»i  
  - Táº§n sá»‘ tá»©c thá»i  
  - Pha tá»©c thá»i  
- CÃ¡c Ä‘áº·c trÆ°ng nÃ y pháº£n Ã¡nh sai lá»‡ch pháº§n cá»©ng vi mÃ´, táº¡o â€œdáº¥u vÃ¢n tayâ€ riÃªng cho thiáº¿t bá»‹.

#### Äáº·c trÆ°ng TFED
- Sá»­ dá»¥ng **Hilbert-Huang transform** Ä‘á»ƒ phÃ¢n tÃ­ch tÃ­n hiá»‡u theo miá»n thá»i gian â€“ táº§n sá»‘.  
- TrÃ­ch xuáº¥t cÃ¡c nhÃ³m Ä‘áº·c trÆ°ng:  
  - **Transient Signal** (vÃ­ dá»¥: thá»i lÆ°á»£ng, nÄƒng lÆ°á»£ng, entropy pha)  
  - **Envelope** (vÃ­ dá»¥: nÄƒng lÆ°á»£ng, phÆ°Æ¡ng sai phong bÃ¬)  
  - **TFED-Time** (vÃ­ dá»¥: Ä‘á»™ dá»‘c, phÆ°Æ¡ng sai, cá»±c Ä‘áº¡i phÃ¢n bá»‘ nÄƒng lÆ°á»£ng)  
  - **TFED-Frequency** (vÃ­ dá»¥: cá»±c Ä‘áº¡i, phÆ°Æ¡ng sai nÄƒng lÆ°á»£ng)  
- Háº¡n cháº¿: cáº§n **trÃ­ch xuáº¥t thá»§ cÃ´ng**, phá»¥ thuá»™c vÃ o viá»‡c xÃ¡c Ä‘á»‹nh chÃ­nh xÃ¡c *transient*, dá»… máº¥t thÃ´ng tin khi táº§n sá»‘ láº¥y máº«u tháº¥p.

### PhÃ¢n loáº¡i tÃ­n hiá»‡u vá»›i RiftNet

<p>
    <img src="assets/2025-09-02-rff/riftnet_architecture.png" alt="KiÃªÌn truÌc mÃ´ hiÌ€nh RiftNet"/>
    <em>KiÃªÌn truÌc mÃ´ hiÌ€nh RiftNet</em>
</p>

- RiftNet cÃ³ **hai nhÃ¡nh**:  
  - NhÃ¡nh (A): xá»­ lÃ½ Ä‘oáº¡n tÃ­n hiá»‡u dÃ i (~16 Î¼s).  
  - NhÃ¡nh (B): xá»­ lÃ½ Ä‘oáº¡n tÃ­n hiá»‡u ngáº¯n (~2.5 Î¼s).  
- Cáº£ hai nhÃ¡nh dÃ¹ng **Dilated Convolutional Cells (DCC)** vá»›i tá»· lá»‡ giÃ£n khÃ¡c nhau Ä‘á»ƒ khai thÃ¡c thÃ´ng tin Ä‘a má»©c thá»i gian.  
- Káº¿t quáº£ trung gian Ä‘Æ°á»£c káº¿t há»£p báº±ng **skip connections** rá»“i Ä‘Æ°a vÃ o táº§ng phÃ¢n loáº¡i.  
- Æ¯u Ä‘iá»ƒm: khai thÃ¡c hiá»‡u quáº£ Ä‘áº·c trÆ°ng RF, giáº£m phá»¥ thuá»™c vÃ o bÆ°á»›c trÃ­ch xuáº¥t thá»§ cÃ´ng.

### Metric Learning vÃ  Open Set Problem

- Sau khi huáº¥n luyá»‡n **RiftNet**, lá»›p softmax Ä‘Æ°á»£c bá» Ä‘i.  
- Ãp dá»¥ng **metric learning** vá»›i **contrastive loss**, huáº¥n luyá»‡n thÃªm **20 epoch**.  
- TrÃ­ch xuáº¥t vector tiá»m áº©n (latent vectors) cá»§a ngÆ°á»i dÃ¹ng Ä‘Ã£ biáº¿t vÃ  láº­p chá»‰ má»¥c báº±ng **FAISS** Ä‘á»ƒ truy váº¥n vÃ  Ä‘Ã¡nh giÃ¡.  
- Äáº·t ngÆ°á»¡ng **1.0 (Euclidean distance)** trong khÃ´ng gian embedding Ä‘á»ƒ phÃ¢n biá»‡t **ngÆ°á»i dÃ¹ng Ä‘Ã£ biáº¿t** vÃ  **ngÆ°á»i dÃ¹ng chÆ°a biáº¿t**.  

<a name="-experiment"></a>  
## 4. ThÆ°Ì‰ nghiÃªÌ£m

### Dá»¯ liá»‡u
- Bá»™ dá»¯ liá»‡u cÃ´ng khai tá»« nghiÃªn cá»©u cá»§a Uzundurukan et al. (2020), xuáº¥t báº£n á»Ÿ táº¡p chÃ­ Data, MDPI vÃ o nÄƒm 2020, vá»›i tiÃªu Ä‘á» bÃ i bÃ¡o â€œA Database for the Radio Frequency Fingerprinting of Bluetooth Devicesâ€.
- Link bÃ i bÃ¡o: https://www.mdpi.com/2306-5729/5/2/55
- Link bá»™ dá»¯ liá»‡u: https://doi.org/10.5281/zenodo.3876140
- TÃ­n hiá»‡u **Bluetooth (BT)**, tá»‘c Ä‘á»™ láº¥y máº«u **250 Msps**.  
- Gá»“m **13 thiáº¿t bá»‹** thuá»™c **5 thÆ°Æ¡ng hiá»‡u**, tá»•ng cá»™ng ~1950 báº£n ghi tá»« 33 Ä‘iá»‡n thoáº¡i.  
- Chia dá»¯ liá»‡u: **80% train â€“ 20% test**.  

**Danh sÃ¡ch thiáº¿t bá»‹:** iPhone 4s, 5, 5s, 6, 6s, 7, 7 Plus, LG G4, Samsung Note 2, Note 3, S3, J7, Xiaomi Mi 6.  

### PhÃ¢n loáº¡i vá»›i Machine Learning
- MÃ´ hÃ¬nh sá»­ dá»¥ng: **SVM, LDA, Decision Tree, Random Forest, XGBoost, CatBoost, Gradient Boosting**.  
- ThÆ° viá»‡n: `scikit-learn`, `XGBoost`, `CatBoost`.  
- DÃ¹ng siÃªu tham sá»‘ máº·c Ä‘á»‹nh.  
- Huáº¥n luyá»‡n vÃ  Ä‘Ã¡nh giÃ¡ trÃªn cÃ¹ng táº­p dá»¯ liá»‡u.  

### PhÃ¢n loáº¡i vá»›i RiftNet
- Huáº¥n luyá»‡n **100 epoch**.  
- Optimizer: **Adam**, learning rate = `1e-4`.  
- Loss function: **cross-entropy** (phÃ¹ há»£p cho phÃ¢n loáº¡i).  

<a name="-result"></a>  
## 5. KÃªÌt quaÌ‰

### PhÃ¢n loáº¡i vá»›i Há»c mÃ¡y
- **Äáº·c trÆ°ng pha tá»©c thÃ¬** (Instantaneous features):  
  - SVM Ä‘áº¡t **67.42% (train)** vÃ  chá»‰ **42.22% (test)** â†’ hiá»‡u quáº£ tháº¥p.  

- **Äáº·c trÆ°ng TFED**:  
  - LDA: 73.64% (train) / 72.93% (test)  
  - Decision Tree: 100% / 56.57%  
  - Random Forest: 100% / 69.19%  
  - XGBoost: 100% / 70.61%  
  - CatBoost: 99.12% / 72.12%  
  - Gradient Boosting: 99.55% / 65.35%  

ğŸ‘‰ Káº¿t quáº£ cho tháº¥y hiá»‡n tÆ°á»£ng **overfitting**: mÃ´ hÃ¬nh Ä‘áº¡t Ä‘á»™ chÃ­nh xÃ¡c ráº¥t cao trÃªn táº­p huáº¥n luyá»‡n nhÆ°ng giáº£m máº¡nh trÃªn táº­p kiá»ƒm tra. NguyÃªn nhÃ¢n chÃ­nh lÃ  **khÃ³ xÃ¡c Ä‘á»‹nh chÃ­nh xÃ¡c giai Ä‘oáº¡n transient**, khiáº¿n Ä‘áº·c trÆ°ng thá»§ cÃ´ng (instantaneous, TFED) chÆ°a Ä‘á»§ máº¡nh.  

### PhÃ¢n loáº¡i vá»›i RiftNet

<p>
    <img src="assets/2025-09-02-rff/riftnet_loss.png" alt="ÄÃ´Ì€ thiÌ£ haÌ€m loss trong quaÌ triÌ€nh training"/>
    <em>ÄÃ´Ì€ thiÌ£ haÌ€m loss trong quaÌ triÌ€nh training</em>
</p>

<p>
    <img src="assets/2025-09-02-rff/riftnet_train_acc.png" alt="ÄÃ´Ì€ thiÌ£ accuracy trÃªn tÃ¢Ì£p train"/>
    <em>ÄÃ´Ì€ thiÌ£ accuracy trÃªn tÃ¢Ì£p train</em>
</p>

<p>
    <img src="assets/2025-09-02-rff/riftnet_test_acc.png" alt="ÄÃ´Ì€ thiÌ£ accuracy trÃªn tÃ¢Ì£p test"/>
    <em>ÄÃ´Ì€ thiÌ£ accuracy trÃªn tÃ¢Ì£p test</em>
</p>

<p>
    <img src="assets/2025-09-02-rff/riftnet_confusion_test.png" alt="Confusion matrix trÃªn tÃ¢Ì£p test"/>
    <em>Confusion matrix trÃªn tÃ¢Ì£p test</em>
</p>

- MÃ´ hÃ¬nh **há»™i tá»¥ nhanh vÃ  á»•n Ä‘á»‹nh**: loss giáº£m máº¡nh á»Ÿ cÃ¡c epoch Ä‘áº§u.  
- Hiá»‡u suáº¥t tÄƒng Ä‘á»u trÃªn cáº£ train vÃ  test.  
- **Káº¿t quáº£ tá»‘t nháº¥t táº¡i epoch 96**:  
  - Train accuracy: **99.4%**  
  - Test accuracy: **96.57%**  
- CÃ³ dao Ä‘á»™ng nháº¹ á»Ÿ test do dá»¯ liá»‡u kiá»ƒm tra cÃ²n **nhá» vÃ  chÆ°a Ä‘a dáº¡ng**, dá»… gÃ¢y sai lá»‡ch phÃ¢n bá»‘ dá»¯ liá»‡u (*distribution shift*).  

ğŸ‘‰ **RiftNet vÆ°á»£t trá»™i hÆ¡n háº³n** so vá»›i cÃ¡c mÃ´ hÃ¬nh há»c mÃ¡y truyá»n thá»‘ng, cho tháº¥y sá»©c máº¡nh cá»§a há»c sÃ¢u trong nháº­n dáº¡ng RFF.

### Káº¿t quáº£ Metric Learning trong Open Set

<p>
    <img src="assets/2025-09-02-rff/scatter_plot.png" alt="t-SNE plot"/>
    <em>BiÃªÌ‰u diÃªÌƒn caÌc latent vector Ä‘Æ°Æ¡Ì£c gom thaÌ€nh caÌc cluster vÆ¡Ìi t-SNE plot</em>
</p>

- Sau khi Ã¡p dá»¥ng **metric learning**, khÃ´ng gian latent hÃ¬nh thÃ nh **cÃ¡c cá»¥m rÃµ rÃ ng** tÆ°Æ¡ng á»©ng vá»›i ngÆ°á»i dÃ¹ng Ä‘Ã£ biáº¿t.  
  - Thiáº¿t bá»‹ cÃ¹ng lá»›p Ä‘Æ°á»£c nhÃ³m thÃ nh cÃ¡c cá»¥m gá»n gÃ ng.  
  - CÃ¡c lá»›p khÃ¡c nhau tÃ¡ch biá»‡t rÃµ rÃ ng.  
  - Thiáº¿t bá»‹ chÆ°a tháº¥y trÆ°á»›c Ä‘Ã³ xuáº¥t hiá»‡n nhÆ° **outliers**, dá»… nháº­n diá»‡n.  

<p>
    <img src="assets/2025-09-02-rff/openset_confusion.png" alt="openset problem trÃªn tÃ¢Ì£p test (coÌ unknown user)"/>
    <em>Openset problem trÃªn tÃ¢Ì£p test (coÌ unknown user)</em>
</p>

- Thá»­ nghiá»‡m trÃªn táº­p test **há»—n há»£p** (cáº£ known vÃ  unknown devices):  
  - **Confusion matrix** cho tháº¥y dá»± Ä‘oÃ¡n cÃ¡c lá»›p Ä‘Ã£ biáº¿t **chÃ­nh xÃ¡c vÃ  á»•n Ä‘á»‹nh**.  
  - Má»™t sá»‘ nháº§m láº«n xáº£y ra chá»§ yáº¿u vá»›i lá»›p **unknown**, Ä‘iá»u nÃ y lÃ  bÃ¬nh thÆ°á»ng trong tÃ¬nh huá»‘ng open-set.  
  - Vá»›i ngÆ°á»¡ng **1.0 (Euclidean distance)**, há»‡ thá»‘ng Ä‘áº¡t **97.05% Ä‘á»™ chÃ­nh xÃ¡c** trong phÃ¢n biá»‡t known/unknown.  

ğŸ‘‰ Káº¿t quáº£ chá»©ng minh RiftNet káº¿t há»£p metric learning cÃ³ **kháº£ nÄƒng tá»•ng quÃ¡t cao** vÃ  tiá»m nÄƒng máº¡nh trong **xÃ¡c thá»±c thiáº¿t bá»‹ dá»±a trÃªn tÃ­n hiá»‡u vÃ´ tuyáº¿n trong mÃ´i trÆ°á»ng open-set**.

BaÌ€i baÌo Ä‘Æ°Æ¡Ì£c xuÃ¢Ìt baÌ‰n Æ¡Ì‰ hÃ´Ì£i nghiÌ£ APSIPA ASC 2025, [check here]().

Code Ä‘Æ°á»£c sá»­ dá»¥ng trong nghiÃªn cá»©u náº±m á»Ÿ repository nÃ y, [check here](https://github.com/frogdance/rff-based-deep-metric-learning).